# MoneyJars 开发路线图与待办清单

## 📋 项目信息
- **项目**: MoneyJars - 智能记账应用
- **当前版本**: v1.0.0+1
- **文档版本**: TODO v2.0
- **更新日期**: 2025年7月17日
- **状态**: 持续开发中

---

## 🎯 当前项目状态

### ✅ 已完成功能
- **核心MVP**: 三罐头主界面 + 拖拽式分类记录 + 本地数据存储
- **UI优化**: 移动端响应式设计 + 背景过渡效果 + 导航系统
- **代码重构**: 模块化架构 + 组件拆分 + 详细注释
- **浏览器兼容**: 支持所有主流浏览器包括微信、iOS Safari
- **Web部署**: GitHub Pages部署 + 环境检查

### 🔄 架构升级 (刚完成)
- **模块化组件**: 按功能区域拆分代码，提升可维护性
- **详细文档**: 完整的组件文档和函数定位指南
- **浏览器支持**: 全面的浏览器兼容性检查

---

## 🚀 T0 优先级任务 (急需完成，1-2周内)

### 1. 完善罐头详情页面 📊
**📁 文件**: `lib/screens/jar_detail_page.dart`  
**⏱️ 工作量**: 5-7天  
**👨‍💻 难度**: 中等

#### 当前状态
- 已有基础框架，但功能不完整
- 缺少详细的交易记录列表
- 没有筛选和搜索功能

#### 需要完成的功能
- [ ] **完整交易记录列表**
  - 显示所有收入/支出明细
  - 按时间倒序排列
  - 支持分页加载
  - 列表项包含：金额、描述、分类、时间

- [ ] **基础筛选功能**
  - 时间范围筛选 (今天/本周/本月)
  - 分类筛选 (单选)
  - 筛选条件保存

- [ ] **搜索功能**
  - 按描述关键词搜索
  - 搜索历史记录

#### 技术要点
```dart
// 需要扩展的组件
class JarDetailPage extends StatefulWidget {
  // 添加分页控制器
  final ScrollController _scrollController;
  
  // 添加筛选状态管理
  DateRange? _selectedDateRange;
  String? _selectedCategory;
  String _searchQuery = '';
}
```

---

### 2. 修复现有功能Bug 🐛
**📁 文件**: 多个文件  
**⏱️ 工作量**: 3-5天  
**👨‍💻 难度**: 中等

#### 需要修复的问题
- [ ] **背景过渡检查**
  - 验证支出页面过渡是否真的丝滑
  - 如果还有问题，进一步优化过渡逻辑

- [ ] **移动端兼容性**
  - 测试Android/iOS设备兼容性
  - 修复可能的布局问题

- [ ] **数据持久化**
  - 确保数据正确保存和加载
  - 处理数据迁移问题

#### 技术要点
- 重点测试`background_widget.dart`的过渡效果
- 检查`env_check_web.dart`的浏览器检测

---

### 3. 优化性能和用户体验 ⚡
**📁 文件**: 多个组件  
**⏱️ 工作量**: 2-3天  
**👨‍💻 难度**: 容易

#### 优化项目
- [ ] **动画性能**
  - 优化滑动提示呼吸动画
  - 减少不必要的重绘
  - 添加动画缓存

- [ ] **加载优化**
  - 添加骨架屏加载
  - 优化图片加载
  - 数据预加载

- [ ] **错误处理**
  - 完善错误提示
  - 添加重试机制
  - 网络错误处理

---

## 📈 T1 优先级任务 (重要功能，2-4周内)

### 4. 高级数据统计和图表 📊
**📁 文件**: `lib/widgets/analytics/` (新建)  
**⏱️ 工作量**: 1-2周  
**👨‍💻 难度**: 中高

#### 功能描述
在当前基础上添加数据可视化分析功能

#### 需要开发的功能
- [ ] **基础统计图表**
  - 支出分类饼图 (基于现有分类系统)
  - 收入支出趋势线图 (按日/周/月)
  - 净收入变化趋势

- [ ] **简单报告**
  - 月度支出报告
  - 分类支出排行
  - 预算完成度分析

#### 技术实现
```dart
// 新增组件架构
lib/widgets/analytics/
├── simple_chart_widget.dart     // 简单图表组件
├── expense_pie_chart.dart       // 支出饼图
├── trend_line_chart.dart        // 趋势线图
└── monthly_report_widget.dart   // 月度报告

// 依赖包
dependencies:
  fl_chart: ^0.65.0              # 图表库
```

---

### 5. 分类管理系统升级 🏷️
**📁 文件**: `lib/screens/category_management_page.dart` (新建)  
**⏱️ 工作量**: 1周  
**👨‍💻 难度**: 中等

#### 当前分类系统限制
- 只支持预定义分类
- 无法自定义分类
- 分类管理功能缺失

#### 需要开发的功能
- [ ] **分类CRUD操作**
  - 创建自定义分类
  - 编辑分类 (名称/颜色/图标)
  - 删除分类 (含数据处理)
  - 分类启用/禁用

- [ ] **分类组织**
  - 分类排序
  - 常用分类快速选择
  - 分类使用频率统计

#### 技术实现
```dart
// 新增页面
class CategoryManagementPage extends StatefulWidget {
  // 分类CRUD操作
  Future<void> createCategory(Category category);
  Future<void> updateCategory(String id, Category category);
  Future<void> deleteCategory(String id);
}
```

---

### 6. 数据导入导出功能 📁
**📁 文件**: `lib/services/import_export_service.dart` (新建)  
**⏱️ 工作量**: 1-2周  
**👨‍💻 难度**: 中高

#### 功能描述
提供数据备份和迁移功能

#### 需要开发的功能
- [ ] **数据导出**
  - CSV格式导出
  - 自定义导出范围
  - 导出预览功能

- [ ] **数据导入**
  - CSV文件导入
  - 数据验证和清理
  - 重复数据检测

#### 技术实现
```dart
// 新增服务
class ImportExportService {
  Future<File> exportToCSV(DateRange range);
  Future<ImportResult> importFromCSV(File file);
  Future<List<ValidationError>> validateData(List<Map> data);
}

// 依赖包
dependencies:
  csv: ^5.0.2                    # CSV处理
  file_picker: ^6.1.1           # 文件选择
```

---

## 🔮 T2 优先级任务 (长期规划，1-3个月内)

### 7. 云端数据同步 ☁️
**📁 文件**: `lib/services/sync_service.dart` (新建)  
**⏱️ 工作量**: 3-4周  
**👨‍💻 难度**: 高

#### 功能描述
实现跨设备数据同步功能

#### 技术选型
- **Firebase**: 快速实现，成本较高
- **Supabase**: 开源方案，功能完整
- **自建服务**: 完全控制，开发成本高

#### 主要功能
- [ ] **用户认证**
  - 邮箱/密码注册登录
  - 社交登录 (Google/Apple)
  - 匿名用户升级

- [ ] **数据同步**
  - 实时数据同步
  - 冲突解决机制
  - 离线数据缓存

---

### 8. 移动端应用打包 📱
**📁 文件**: 构建配置  
**⏱️ 工作量**: 2-3周  
**👨‍💻 难度**: 中等

#### 平台支持
- [ ] **Android版本**
  - Google Play上架准备
  - 签名和打包配置
  - 性能优化

- [ ] **iOS版本**
  - App Store上架准备
  - 证书配置
  - iOS特有功能集成

#### 技术要点
```bash
# Android构建
flutter build apk --release

# iOS构建
flutter build ios --release
```

---

### 9. 高级主题和个性化 🎨
**📁 文件**: `lib/themes/` (新建)  
**⏱️ 工作量**: 1-2周  
**👨‍💻 难度**: 中等

#### 功能描述
提供更多个性化选项

#### 主要功能
- [ ] **多主题支持**
  - 深色/浅色模式
  - 自定义配色方案
  - 主题预览

- [ ] **个性化设置**
  - 货币单位设置
  - 语言切换
  - 通知设置

---

## 📊 工作量汇总

### 按优先级统计
| 优先级 | 任务数量 | 总工作量 | 建议人员 |
|--------|----------|----------|----------|
| T0 | 3个任务 | 10-15天 | 1-2人 |
| T1 | 3个任务 | 3-5周 | 2-3人 |
| T2 | 3个任务 | 6-10周 | 2-4人 |

### 技能需求
- **前端开发**: Flutter/Dart 熟练
- **UI设计**: 界面设计和用户体验
- **后端开发**: 数据同步和API设计 (T2阶段)
- **移动开发**: Android/iOS平台经验 (T2阶段)

---

## 🎯 近期开发建议

### 立即开始 (本周内)
1. **罐头详情页面完善** - 这是用户最期待的功能
2. **现有功能Bug修复** - 确保现有功能稳定

### 下周计划
1. **性能优化** - 提升用户体验
2. **开始T1任务规划** - 准备下个阶段开发

### 月度目标
- 完成所有T0任务
- 启动T1任务中的数据统计功能
- 进行用户测试和反馈收集

---

## 🛠️ 开发环境和工具

### 必需工具
- **IDE**: VS Code + Flutter插件
- **版本控制**: Git
- **设计工具**: Figma (UI设计)
- **调试工具**: Flutter DevTools

### 推荐依赖包
```yaml
# 当前项目依赖
dependencies:
  flutter:
    sdk: flutter
  provider: ^6.1.0
  flutter_screenutil: ^5.9.0
  sqflite: ^2.3.0
  
# T1阶段新增
  fl_chart: ^0.65.0              # 图表
  csv: ^5.0.2                    # CSV处理
  file_picker: ^6.1.1           # 文件选择
  
# T2阶段新增
  firebase_core: ^2.24.2         # Firebase
  supabase_flutter: ^2.0.0       # Supabase
```

---

## 📈 成功指标

### 技术指标
- **功能完成度**: T0任务100%完成
- **代码质量**: 保持现有的详细注释标准
- **性能**: 启动时间 < 3秒，操作响应 < 200ms
- **兼容性**: 支持95%目标浏览器

### 用户体验指标
- **功能可用性**: 核心功能100%可用
- **界面响应**: 流畅的动画和过渡
- **数据准确性**: 计算错误率 < 0.1%

---

## 🔄 版本发布计划

### v1.1.0 (T0完成后)
- 完善的罐头详情页面
- 修复所有已知Bug
- 性能优化

### v1.2.0 (T1完成后)
- 数据统计和图表
- 分类管理系统
- 数据导入导出

### v2.0.0 (T2完成后)
- 云端同步功能
- 移动端App
- 完整的主题系统

---

*文档版本: TODO v2.0*  
*最后更新: 2025年7月17日*  
*维护者: 开发团队*